# SQL Tutorial 04

## Views
뷰는 SQL실행 결과에 기반한 가상 테이블이다. 

>여러 테이블이나 또다른 뷰에서 데이터를 선택해, 사용자 정의해서 나타낼 수 있다.
>
>뷰는 기본 테이블(table)과 같이 행(column)과 열(row)로 구성되지만, 다른 테이블에 있는 데이터를 보여줄 뿐이며, 실제 테이블과 달리 데이터 자체를 포함하고 있는 것은 아니다. 뷰를 사용하면 여러 테이블이나 뷰를 하나의 테이블인 것처럼 볼 수 있다.


>[위키백과 - VIEW](https://ko.wikipedia.org/wiki/VIEW_(SQL)) 

### 뷰 생성하기
```sql
CREATE VIEW view_name AS
SELECT column_name(s)
FROM table_name
WHERE condition
```
**뷰는 항상 최신 데이터를 보여준다. 데이터베이스 엔진은 뷰를 쿼리할때마다 다시 데이터를 생성한다.**

### 뷰 생성 예제 
```sql
CREATE VIEW [Current Product List] AS
SELECT ProductID,ProductName
FROM Products
WHERE Discontinued=No
```
위와 같이 다른 테이블의 데이터로 `[Current Product List]`라는 뷰를 만들었다. 다음과 같이 쿼리할 수 있다.

```sql
SELECT * FROM [Current Product List]
```

WHERE절에 함수를 추가해서 생성할 수도 있다. 
```sql 
CREATE VIEW [Products Above Average Price] AS
SELECT ProductName,UnitPrice
FROM Products
WHERE UnitPrice>(SELECT AVG(UnitPrice) FROM Products)
```

다른 뷰를 이용해 새로운 뷰를 만들었다.
```sql
CREATE VIEW [Category Sales For 1997] AS
SELECT DISTINCT CategoryName,Sum(ProductSales) AS CategorySales
FROM [Product Sales for 1997]
GROUP BY CategoryName
```

### 뷰 갱신하기 
#### CREATE OR REPLACE VIEW
```sql
CREATE OR REPLACE VIEW view_name AS
SELECT column_name(s)
FROM table_name
WHERE condition
```

다음과 같이 뷰에 컬럼을 추가할 수 있다. 
```sql 
CREATE OR REPLACE VIEW [Current Product List] AS
SELECT ProductID,ProductName,Category
FROM Products
WHERE Discontinued=No
```
생셩될 때 ProductID,ProductName 컬럼만 있던 뷰에 Category컬럼을 추가했다.

### 뷰 삭제하기 
```sql
DROP VIEW view_name
```

## Date Functions
>날짜 데이터를 다룰때 가장 어려운 점은 입력하려는 날짜 데이터 형식과 데이터베이스 컬럼에 있는 날짜 데이터 형식을 맞춰주는 일이다. 

시간 데이터를 다룰 때 쿼리 실행을 간단하고 쉽게 하려면, 데이터 포맷 형식을 너무 자세하지 않게 하는게 좋다!
> 나쁜예 
> `SELECT * FROM Orders WHERE OrderDate='2008-11-11 11:12:01'`
> 


### 내장 함수의 종류 
#### MySQL Date Functions

|함수   |표시형식   |설명   |
|---|---|---|
| NOW()  |2014-11-22 12:45:34|현재 날짜와 시각을 반환| 
| CURDATE()	  |2014-11-22|현재 날짜를 반환| 
|CURTIME()|12:45:34|현재 시각을 반환| 
| DATE()	|2014-11-22|날짜/시각 표현에서 날짜만 추출| 
|EXTRACT()|   |날짜/시각, 년,월,일,시,분 등 한 부분만 반환| 
|DATE_ADD()|   |date데이터에 특정 시간을 추가   |
|DATE_SUB()|   |date데이터에서 특정 시간을 앞당김  |
|DATEDIFF()|   |두 date사이의 차이를 반환   |
|DATE_FORMAT()|   |보여지는 형식을 바꿔준다   |

>date 데이터 형식의 종류
>
* MICROSECOND
* SECOND
* MINUTE
* HOUR
* DAY
* WEEK
* MONTH
* QUARTER
* YEAR
* SECOND_MICROSECOND
* MINUTE_MICROSECOND
* MINUTE_SECOND
* HOUR_MICROSECOND
* HOUR_SECOND
* HOUR_MINUTE
* DAY_MICROSECOND
* DAY_SECOND
* DAY_MINUTE
* DAY_HOUR
* YEAR_MONTH


#### SQL Server Date Functions
|함수|표시형식   |설명   |
|---|---|---|
| GETDATE()  |2014-11-22 12:45:34.243|현재 날짜와 시각 반환|
|DATEPART()|   |날짜/시각, 년,월,일,시,분 등 한 부분만 반환|
|DATEADD()|   |date데이터에 특정 시간을 추가|
|  DATEDIFF()	 |   |두 date사이의 차이를 반환 |
|CONVERT()|   |다른 형식으로 보여준다|

### SQL Date Data Types
#### MySQL:

* DATE - format YYYY-MM-DD
* DATETIME - format: YYYY-MM-DD HH:MI:SS
* TIMESTAMP - format: YYYY-MM-DD HH:MI:SS
* YEAR - format YYYY or YY

#### SQL Server:

* DATE - format YYYY-MM-DD
* DATETIME - format: YYYY-MM-DD HH:MI:SS
* SMALLDATETIME - format: YYYY-MM-DD HH:MI:SS
* TIMESTAMP - format: a unique number


## NULL Values
null값은 결여되어 다룰 수 없는 데이터이다. 컬럼은 기본적으로 널값을 가질 수 있다. 

