# SQL Tutorial 03

## CREATE DATABASE
새로운 데이터베이스를 만든다.

### 실행문 
`
CREATE DATABASE dbname;
`

## CREATE TABLE
새로운 테이블을 만든다. 반드시 테이블에는 이름이 있어야 한다.

```
CREATE TABLE table_name
(
column_name1 data_type(size),
column_name2 data_type(size),
column_name3 data_type(size),
....
);
```
* data type의 종류
	* varchar - 문자형
	* integer - 정수형
	* decimal - 실수형
	* date - 날짜형
	* 기타


### 실행문  	
```sql
CREATE TABLE Persons
(
PersonID int,
LastName varchar(255),
FirstName varchar(255),
Address varchar(255),
City varchar(255)
);
```
(255)는 데이터의 크기를 나타낸다. 255자까지 들어갈 수 있다. 만들어진 테이블에는 INSERT INTO로 데이터를 채운다.

## Constraints
테이블에 삽입하는 데이터에 제약조건을 걸어준다. 제약조건은 테이블을 생성할 때 (CREATE TABLE실행문 안에서) 걸어주거나, 생성된 테이블에 (ALTER TABLE실행문으로 ) 걸어줄 수 있다. 

### 실행문 
```
CREATE TABLE table_name
(
column_name1 data_type(size) constraint_name,
column_name2 data_type(size) constraint_name,
column_name3 data_type(size) constraint_name,
....
);
```

### 제약조건의 종류
* NOT NULL - NULL값을 담을 수 없다. (반드시 데이터가 채워져야 한다.)
* UNIQUE - 컬럼의 각 row의 값이 반드시 고유한 값을 가져야 한다.
* PRIMARY KEY - NULL값이 아니며 동시에 고유한 값을 가져야 한다. 이 컬럼은 고유한 정체성을 가지며, 특정 레코드를 쉽고 빠르게 찾을 수 있게 해준다. 
* FOREIGN KEY - 한 테이블과 다른 테이블에 서로 일치하는 데이터가 있어서 참조하는 관계일때 참조무결성을 보장해준다. 
* CHECK - 컬럼값이 특정조건을 가진다. 
* DEFAULT - 특정 기본값을 가진다.

## NOT NULL Constraint
컬럼이 항상 NULL이 아닌 값을 갖도록 강제한다. **한 컬럼이 이 제약조건을 가지면 이 컬럼값을 넣어주지 않는 한 새로운 레코드를 insert하거나 update할 수 없다. ** 

## UNIQUE Constraint
이 제약조건은 각 레코드를 고유하게 식별할 수 있게 해준다. unique와 primary key모두 컬럼의 독자성을 보장한다. 그러나 **한 테이블에 unique 제약조건은 여러개 둘 수 있지만 primary key는 한개만 둘 수 있다.**

### 테이블 생성시 실행문 
* SQL Server / Oracle / MS Access:

```
CREATE TABLE Persons
(
P_Id int NOT NULL UNIQUE,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255)
)
```

* MySQL:


```
CREATE TABLE Persons
(
P_Id int NOT NULL,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255),
UNIQUE (P_Id)
)
```

### 여러 칼럼 조합에 unique조건을 주기

```
CREATE TABLE Persons
(
P_Id int NOT NULL,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255),
CONSTRAINT uc_PersonID UNIQUE (P_Id,LastName)
)
```
제약조건에 이름(uc_PersonID)을 붙일 수 있다. 이 경우 여러 칼럼의 조합으로 생긴 unique조건이어서 **한 컬럼내의 데이터 고유성을 보장하는 것이 아니라, 컬럼 조합의 데이터 고유성을 보장한다.** 즉, P_Id 와 LastName 의 조합이 고유해야 한다. 예를들어 (1, kim) 과 (1, Lee)는 P_Id칼럼내의 값이 동일하지만 조합은 서로 다르기 때문에 허용된다. 

### 테이블 생성후에 제약조건 걸기
```
ALTER TABLE Persons
ADD UNIQUE (P_Id)
```

여러 컬럼 조합에 제약을 거는 방법은 다음과 같다.

```
ALTER TABLE Persons
ADD CONSTRAINT uc_PersonID UNIQUE (P_Id,LastName)
```

### 제약조건의 삭제 
* MySQL:


```
ALTER TABLE Persons
DROP INDEX uc_PersonID
```

* SQL Server / Oracle / MS Access:

```
ALTER TABLE Persons
DROP CONSTRAINT uc_PersonID
```

## PRIMARY KEY Constraint
이 제약조건은 반드시 unique값을 가져야 한다. (즉, 이 제약조건이 걸린 컬럼은 당연히 unique제약조건도 갖는다.) 그리고 NULL값을 갖을 수 없다. 대부분의 테이블은 primary key를 가져야 하며 테이블당 하나씩만 가질 수 있다. 

### 테이블 생성시 
* MySQL:

```
CREATE TABLE Persons
(
P_Id int NOT NULL,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255),
PRIMARY KEY (P_Id)
)
```

* SQL Server / Oracle / MS Access:

```
CREATE TABLE Persons
(
P_Id int NOT NULL PRIMARY KEY,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255)
)
```

### 여러 컬럼 조합을 primary key값으로 설정하기 
```
CREATE TABLE Persons
(
P_Id int NOT NULL,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255),
CONSTRAINT pk_PersonID PRIMARY KEY (P_Id,LastName)
)
```
하나의 primary key가 두개의 컬럼의 조합을 값으로 갖는다. 

### 생성된 테이블에 제약걸기 
```
ALTER TABLE Persons
ADD PRIMARY KEY (P_Id)
```

* 여러 컬럼 조합을 키값으로 갖게할 경우

```
ALTER TABLE Persons
ADD CONSTRAINT pk_PersonID PRIMARY KEY (P_Id,LastName)
```
**테이블이 처음 만들어졌을때 ALTER로 primary key제약을 걸려고 한다면, 제약을 걸기위한 컬럼은 NULL값을 허용하지 않도록 되어있어야 한다.**

### 제약조건 삭제하기 
* MySQL:

```
ALTER TABLE Persons
DROP PRIMARY KEY
```

* SQL Server / Oracle / MS Access:

```
ALTER TABLE Persons
DROP CONSTRAINT pk_PersonID
```

## FOREIGN KEY Constraint
